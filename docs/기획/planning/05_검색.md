# 05. 검색 시스템

## 개요

헤더의 통합 검색은 콘텐츠, 사용자, 태그, 내 기록을 모드별로 검색하는 허브다. 검색 모드를 먼저 선택한 후 검색어를 입력하여 범위를 명확히 한다.

---

## 검색 모드

| 모드 | 아이콘 | 검색 대상 | placeholder |
|------|--------|-----------|-------------|
| 콘텐츠 | 📚 | 책, 영화, 드라마, 게임 등 | "작품명, 저자, 감독..." |
| 사용자 | 👤 | Feel&Note 유저 | "닉네임, @username..." |
| 태그 | # | 콘텐츠/리뷰 태그 | "태그명..." |
| 내 기록 | 📁 | 내 기록관 콘텐츠만 | "내 기록관에서 검색..." |

---

## UI 구조

### 검색바 (헤더)

```
┌─────────────────────────────────────────────────────────────┐
│ [콘텐츠 ▾] │ 🔍 검색어 입력...                        │ ✕ │
└─────────────────────────────────────────────────────────────┘
      ↑
   모드 선택 드롭다운
```

### 모드 선택 드롭다운

```
┌─────────────┐
│ 📚 콘텐츠   │ ← 기본값
│ 👤 사용자   │
│ #  태그     │
│ 📁 내 기록  │
└─────────────┘
```

---

## 모드별 자동완성

### 콘텐츠 모드

```
┌─────────────────────────────────────────────────────────────┐
│ [콘텐츠 ▾] │ 🔍 해리                                  │ ✕ │
├─────────────────────────────────────────────────────────────┤
│ 📚 해리포터와 마법사의 돌 · J.K. 롤링                      │
│ 📚 해리포터와 비밀의 방 · J.K. 롤링                        │
│ 🎬 해리포터와 아즈카반의 죄수 (2004)                       │
│ 🎬 해리포터와 불의 잔 (2005)                               │
├─────────────────────────────────────────────────────────────┤
│ "해리" 검색 결과 더보기 →                                  │
└─────────────────────────────────────────────────────────────┘
```

- 외부 API (알라딘, TMDB 등) + 내부 DB 통합 검색
- 카테고리 아이콘으로 콘텐츠 유형 표시
- 최대 5개 자동완성 결과

### 사용자 모드

```
┌─────────────────────────────────────────────────────────────┐
│ [사용자 ▾] │ 🔍 book                                  │ ✕ │
├─────────────────────────────────────────────────────────────┤
│ 👤 BookLover · @booklover · 팔로워 1.2K                    │
│ 👤 책벌레김씨 · @bookworm_kim · 팔로워 890                 │
│ 👤 북클럽회장 · @bookclub_ceo · 팔로워 456                 │
├─────────────────────────────────────────────────────────────┤
│ "book" 검색 결과 더보기 →                                  │
└─────────────────────────────────────────────────────────────┘
```

- 닉네임, username 모두 검색
- 팔로워 수 표시
- 최대 5개 자동완성 결과

### 태그 모드

```
┌─────────────────────────────────────────────────────────────┐
│ [태그 ▾]   │ 🔍 판타                                  │ ✕ │
├─────────────────────────────────────────────────────────────┤
│ # 판타지 · 게시물 12,345개                                 │
│ # 판타지소설 · 게시물 3,456개                              │
│ # 판타지영화 · 게시물 2,100개                              │
├─────────────────────────────────────────────────────────────┤
│ "판타" 검색 결과 더보기 →                                  │
└─────────────────────────────────────────────────────────────┘
```

- 태그 사용 빈도(게시물 수) 표시
- 인기순 정렬
- 최대 5개 자동완성 결과

### 내 기록 모드

```
┌─────────────────────────────────────────────────────────────┐
│ [내 기록 ▾] │ 🔍 해리                                 │ ✕ │
├─────────────────────────────────────────────────────────────┤
│ 📚 해리포터와 마법사의 돌 · 완료 · ★★★★★                  │
│ 🎬 해리포터와 아즈카반의 죄수 · 감상중 · 50%               │
├─────────────────────────────────────────────────────────────┤
│ 내 기록관에서 2건                                          │
└─────────────────────────────────────────────────────────────┘
```

- 내 기록관에 추가된 콘텐츠만 검색
- 상태, 별점/진행률 표시
- 결과 수 표시

---

## 키보드 단축키

| 단축키 | 동작 |
|--------|------|
| `Ctrl+K` / `Cmd+K` | 검색창 포커스 |
| `Tab` | 다음 모드로 전환 |
| `Shift+Tab` | 이전 모드로 전환 |
| `@` 입력 시 | 사용자 모드로 전환 |
| `#` 입력 시 | 태그 모드로 전환 |
| `↑` / `↓` | 자동완성 결과 탐색 |
| `Enter` | 선택 항목으로 이동 / 전체 검색 |
| `Esc` | 검색창 닫기 |

---

## 검색 결과 페이지

### URL 구조

```
/search?mode=content&q=해리
/search?mode=user&q=book
/search?mode=tag&q=판타지
/search?mode=archive&q=해리
```

### 모드별 필터

| 모드 | 필터 옵션 |
|------|-----------|
| 콘텐츠 | 카테고리(도서/영화/드라마/애니/게임/공연), 정렬(관련도/최신) |
| 사용자 | 정렬(팔로워순/최신순), 팔로잉만 필터 |
| 태그 | 정렬(인기순/최신순) |
| 내 기록 | 상태(전체/감상중/완료/관심), 카테고리 |

### 결과 페이지 레이아웃

```
┌─────────────────────────────────────────────────────────────┐
│ [콘텐츠 ▾] │ 🔍 해리                            │ [검색] │
├─────────────────────────────────────────────────────────────┤
│ 카테고리: [전체] [도서] [영화] [드라마] ...                │
│ 정렬: [관련도순 ▾]                                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ "해리" 검색 결과 23건                                      │
│                                                             │
│ ┌─────┬─────┬─────┬─────┐                                  │
│ │ 📚  │ 📚  │ 🎬  │ 🎬  │                                  │
│ │해리 │해리 │해리 │해리 │                                  │
│ │포터1│포터2│포터1│포터2│                                  │
│ └─────┴─────┴─────┴─────┘                                  │
│                                                             │
│ ... (그리드 뷰)                                            │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 검색 로직

### 우선순위

1. **정확 일치**: 검색어와 정확히 일치
2. **시작 일치**: 검색어로 시작
3. **포함 일치**: 검색어를 포함
4. **초성 검색**: 한글 초성 매칭 (`ㅎㄹㅍㅌ` → 해리포터)

### 관련도 가중치

| 요소 | 가중치 |
|------|--------|
| 제목 정확 일치 | ×10 |
| 제목 시작 일치 | ×5 |
| 제목 포함 일치 | ×2 |
| 태그 일치 | ×3 |
| 저자/감독 일치 | ×2 |
| 인기도 (기록관 추가 수) | ×1.5 |

---

## 검색 데이터 소스

| 모드 | 데이터 소스 |
|------|-------------|
| 콘텐츠 | 알라딘 API, TMDB, IGDB + 내부 DB |
| 사용자 | 내부 DB (users) |
| 태그 | 내부 DB (tags) |
| 내 기록 | 내부 DB (user_contents → contents) |

---

## 최근 검색

### 저장

- **위치**: localStorage (비로그인) / DB (로그인)
- **최대 개수**: 모드별 10개
- **만료**: 30일

### 표시 (검색창 포커스 시)

```
┌─────────────────────────────────────────────────────────────┐
│ [콘텐츠 ▾] │ 🔍                                       │ ✕ │
├─────────────────────────────────────────────────────────────┤
│ 최근 검색                                        [지우기] │
│  🕐 해리포터                                              │
│  🕐 반지의 제왕                                           │
│  🕐 채식주의자                                            │
└─────────────────────────────────────────────────────────────┘
```

---

## 빈 상태

### 검색 결과 없음

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│                         🔍                                  │
│                                                             │
│         "asdfqwer"에 대한 검색 결과가 없습니다              │
│                                                             │
│         다른 검색어를 입력해보세요                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 연동 모듈

- **기록관**: 콘텐츠 검색 → 상세 페이지 / 기록관 추가
- **소셜**: 사용자 검색 → 프로필 페이지
- **피드**: 태그 검색 → 태그 피드

---

*05_검색.md*
